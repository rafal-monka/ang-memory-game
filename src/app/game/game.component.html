<h2>Game</h2>

<div>
  <pre *ngIf="user"><small>User: {{user | json }}]</small></pre>
</div>

<div *ngIf="(game$ | async) as g; else loadingBlock">
  <div>
    <pre>Observable&lt;Game&gt; {{g | json}}</pre>
  </div>

  <div *ngIf="(game$ | async)?.gameid; else noGameIdBlock">
    <div [style.background-color]="wssIsActive?'white':'lightgrey'">
        <app-players-view ></app-players-view>
    </div>

    <div *ngIf="(game$ | async)?.status==='NEW' && (game$ | async)?.host===user.sub">
      <app-player-add></app-player-add>
    </div>

    <div>
      <br/><b>{{wssIsActive}}:{{wssIsActive?wssClientID:''}}&nbsp;</b><button (click)="connectWss()">Connect</button><button (click)="disconnectWss()">Disconnect</button>
    </div>

  </div>

  <ng-template #noGameIdBlock>
    <button (click)="newGame()">New game</button>
  </ng-template>
</div>


<ng-template #loadingBlock>
    Loading...
</ng-template>

<button *ngIf="true || allPlayersConnected" (click)="startGame()">Start game</button>

<div *ngIf="board$ | async as board">
  <table border=1>
    <tr *ngFor="let row of _setSIZE; let r=index">
        <td *ngFor="let col of _setSIZE; let c=index">
          <div class="card" (click)="onCardClick(r,c, board[r][c].value)" [style.background-color]="board[r][c].open?'lightgreen':''">
              <b>{{board[r][c].open?board[r][c].value:(board[r][c].value===undefined?'':'^'+board[r][c].value)}}</b>
              <br/><small style="color: blue">{{board[r][c].count}}</small>
          </div>
        </td>
    </tr>
</table>

</div>


<div>

  <pre>wss.messages.length={{messages.length}}<button (click)="clearMessages()">Clear</button></pre>
  <ul>
    <li *ngFor="let msg of messages">
      <small>{{msg}}</small>
    </li>
  </ul>
</div>
